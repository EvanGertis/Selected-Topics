
<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Word Matching Exercise</title>
    <style>
    *:focus {outline: 2px solid blue; outline-offset: 2px;}
    details {padding:3px;}
    </style>
    <link rel="stylesheet" type="text/css" href="boxes.css?v=9999" />
    <script type="text/javascript" src="event1.js?v=9999"></script>
  
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-89940905-27"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());
  gtag('config', 'UA-89940905-27');
</script>

<script type="text/javascript" src="../logging.js"></script>
</head>


  <body>
    <div id="maincontentstyle">
        <div id="boxstyle">
          <h3 id= "title">Section 5.2 Word Matching Exercise</h3>
          <div class="row">
            <div id="inputs" class="column column-1">
                <div id="inputBoxes" class="inputBoxes">
                    <title>Input:</title>
                    <div class="row">
                      Title: <input id= "title_input" type="text">
                    </div>  
                    <div class="row">
                      Key Term 1: <input id="el1" type="text" value="">
                    </div>
                    <div class="row">
                      Description 1: <input id="dl1" type="text" value="">
                    </div>
                    <div class="row">
                      Key Term 2: <input id="el2" type="text" value="">
                    </div>
                    <div class="row">
                      Description 2: <input id="dl2" type="text" value="">
                    </div>
                </div>
                <span style="padding: 3px">
                  <button id ="one" class="button" type="button" onClick="add_more()">add more</button>
                </span>
                <span style="padding: 3px">
                  <button id ="one" class="button" type="button" onClick="generate_html()">generate html</button>
                </span>
            </div>
            </div>
          </div>
          <div id="results" class="row">
          </div>
          <div id="renderedHTML" class="row">
          </div>
        </div>


    
<script src="jquery-1.7.2.min.js"></script>

<script src="jquery-ui.min.js"></script>
<script src="jquery.ui.touch-punch.min.js"></script><script src="jquery.alerts.js"></script><link href="jquery.alerts.css" rel="stylesheet" type="text/css" media="screen" />  

<script type="text/javascript">
$(init);
$( window ).unload(function() {
  removeStorage.removeItem("someVarKey1");
});
function init() {
      document.getElementById('resetButton').style.display = 'none';
document.getElementById("resetButton").style.visibility = "hidden";
if (false && sessionStorage.getItem("someVarKey1")) // No focus for the first time
  $("#one").focus();
  var numbers = [3, 4, 5, 1, 2];
  initialize(numbers);
  

}
</script>
    <script>
    // initially html is not generated.
    var htmlGenerated = false;
    // number of inputs start out as 2.
    var numberOfInputs = 2;
    // initially no addtional inputs have been added.
    var addMore = false;
    // initially html is not rendered
    var htmlRendered = false;
    // initialize the answer.
    var answer = '';
      
    function reset() {
      // reset the htmGenerated to false.
      htmlGenerated = false;
      htmlRendered  = false;
      numberOfInputs = 2;
      var someVarName = true;
      sessionStorage.setItem("someVarKey1", someVarName);
      window.location.reload();
    }

    function show_answer() {
      jAlert(answer, 'Correct Match');
    }

    function generate_html() {
      // retrieve the keys and descriptions. Then load them into their respective arrays.
      const e_inputs = document.querySelectorAll("[id^='el']");
      const d_inputs = document.querySelectorAll("[id^='dl']");
      let elArray = [];
      let dlArray = [];
      const title = document.getElementById('title_input').value;
      for (let i = numberOfInputs; i < elArray.length; i++) {
          text += `${elArray[i]}:${dlArray[i]}\n`;
          answer += elArray[i];
          answer += ':';
          answer += dlArray[i];
          answer += '\n';
      }

      console.log("generating answer");
      console.log(answer);

      //have we added more?
      if(addMore && htmlGenerated){
        // then delete the old textarea.
        textarea = document.getElementById("generated_html_textarea");
        textarea.remove();
        // delete the controls.
        controls = document.getElementById("program1");
        controls.remove();
      }

    
      //has the html already been generated? 
      if(!htmlGenerated){
        e_inputs.forEach( i => { if(i.value) elArray.push(i.value) });
        d_inputs.forEach( i => { if(i.value) dlArray.push(i.value) });

        let text = title + "\n";
        for (let i = numberOfInputs; i < elArray.length; i++) {
            text += `${elArray[i]}:${dlArray[i]}\n`;
        }

        //fetch the results box
        results = document.getElementById("results");

        //create textarea
        textarea = document.createElement("textarea");
        textarea.setAttribute("id","generated_html_textarea");
        
        // initialize blank html
        html = '';

        //create key inputs
        var html_1 = ''
        var html_2 = '<table id=\"tablestyle\">'
        for (let i = numberOfInputs; i < elArray.length+numberOfInputs; i++){
          html_1 += '<div id="s';
          var id   = (1+i-numberOfInputs);
          html_1 += id;
          html_1 +='\" class=\"draggyBox-small\">';
          html_1 += elArray[i-numberOfInputs];
          html_1 +='</div>\n';

          html_2 += '<td id="row';
          html_2 += id;
          html_2 +='">\n';
          html_2 += '\t\t<div id=\"t';
          html_2 +=i-numberOfInputs;
          html_2 +='" class=\"ltarget\"></div>\n \t</td >\n \t<td  id=\"d2\">'
          html_2 +=dlArray[i-numberOfInputs];
          html_2 +='</td >\n </tr>\n';
        }

        html = html_1 + html_2 + '</table>'

        // html generation is done.
        htmlGenerated = true;
        textarea.value = html;
        results.appendChild(textarea);

        // Generate reset, show answer, , and render html buttons
        controls = document.createElement("div");
        controls.setAttribute("id","program1");
        controls.setAttribute("style","border: 1px solid #EB0D1B; width: 360px; font-family: courier; font-size: 100.5%; margin: 0px auto; border: 1px; text-align: center; margin-top: 5px;");
        controls.innerHTML +=  '<span style="padding: 3px"> <button id ="one" class="button" type="button" onClick="show_answer()">Show Answer</button> <button id = "resetButton" class="button" type="button" onClick="reset()">Reset</button><button id = "renderHTMLButton" class="button" type="button" onClick="render_html()">Render html</button> <span id = "audio" style=""> <a href="" title="Turns Text-to-Speech Output On or Off" class="menulink" style="text-decoration: none;"><img id="bg" src="audioOff.png" height="30" width="30" style="margin-bottom:-10px; padding-bottom:-20px;"/> </a> </span> </span>';
        results.appendChild(controls);
      }
    }

    function add_more() {
      // we've added more inputs.
      addMore = true;

      // set html generated to false, because new inputs have been added.
      htmlGenerated = false;
      
      // increment the number of inputs.
      numberOfInputs++;

      //fetch the input boxes.
      inputs = document.getElementById("inputBoxes");
      
      //create a new row for a key term.
      row = document.createElement("div");
      row.setAttribute("class","row");

      // set the key term text.
      row.innerHTML = "Key Term ";
      row.innerHTML +=numberOfInputs;
      row.innerHTML +=" :";

      // create the input for the key.
      key = document.createElement("input");
      key.setAttribute("id","el"+numberOfInputs);

      //add the key to the row.
      row.appendChild(key);

      //create a row for the new description.
      row2 = document.createElement("div");
      row2.setAttribute("class","row");

      // set the description text.
      row2.innerHTML = "Description  "
      row2.innerHTML+=numberOfInputs;
      row2.innerHTML+=" :";

      // create the description input
      description = document.createElement("input");
      description.setAttribute("id","dl"+numberOfInputs);

      // add the description to the row.
      row2.appendChild(description);

      // add the rows for the key and the description to the inputBoxes.
      inputs.appendChild(row);
      inputs.appendChild(row2);
    }

    function render_html(){
      // was html rendered?
      if(!htmlRendered){
        textarea  = document.getElementById("generated_html_textarea");
        generated_html = textarea.value;
        console.log(generated_html);
        maincontentstyle = document.getElementById("maincontentstyle");
        rendered_html = document.createElement("div");
        rendered_html.setAttribute("id","rendered_html");
        rendered_html.setAttribute("style","border: 1px solid #EB0D1B; width: 360px; font-family: courier; font-size: 100.5%; margin: 0px auto; border: 1px; text-align: center; margin-top: 5px;");
        rendered_html.innerHTML +=  generated_html;
        maincontentstyle.appendChild(rendered_html);
        htmlRendered = true;
      }
    }
</script>
   
<script type="text/javascript" src="GetElementPosition3.js"></script>
   <script>
//    $(function(){
//  if ('speechSynthesis' in window) {
//    speechSynthesis.onvoiceschanged = function() {
//      var $voicelist = $('#voices');
//
//      if($voicelist.find('option').length == 0) {
//        speechSynthesis.getVoices().forEach(function(voice, index) {
//          var $option = $('<option>')
//          .val(index)
//          .html(voice.name + (voice.default ? ' (default)' :''));
//
//          $voicelist.append($option);
//        });
//
//        $voicelist.material_select();
//      }
//    }
//  } 
//});     

audioOn = false;
$(function() {
  $('.menulink').click(function(){
    if (audioOn) {
      $("#bg").attr('src',"audioOff.png");  
      audioOn = false;
    }
    else {
      $("#bg").attr('src',"audioOn.png");
      audioOn = true; speak(" ");
    }
    return false;
  });
});
   </script>   

   </body>
</html>